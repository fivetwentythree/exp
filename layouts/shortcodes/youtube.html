{{- $id := .Get 0 -}} {{- $title := .Get 1 | default "YouTube Video" -}} {{/* This
"lite" YouTube embed is adapted from the work of Justin Ribeiro. It's fast,
privacy-friendly, and avoids loading heavy scripts until clicked. */}}

<div
    class="youtube-lite"
    data-videoid="{{ $id }}"
    style="background-image: url('https://i.ytimg.com/vi/{{ $id }}/hqdefault.jpg');"
>
    <a
        href="https://youtube.com/watch?v={{ $id }}"
        target="_blank"
        rel="noopener"
        class="youtube-lite-link"
        aria-label="Watch on YouTube: {{ $title }}"
    >
        <div class="youtube-lite-playbtn" aria-label="Play Video: {{ $title }}"></div>
    </a>
</div>

{{/* The first time a YouTube shortcode is used on a page, add the necessary CSS and JS
to the page footer. This ensures it's only included once. */}} {{- if not
(.Page.Scratch.Get "youtube-lite-assets") -}} {{ .Page.Scratch.Set "youtube-lite-assets"
true }}

<style>
    .youtube-lite {
        position: relative;
        display: block;
        contain: content;
        background-position: center center;
        background-size: cover;
        cursor: pointer;
        border-radius: var(--image-radius, 6px);
        overflow: hidden;
        margin: 2em 0;
    }
    /* Make it responsive */
    .youtube-lite::before {
        content: "";
        display: block;
        padding-bottom: 56.25%; /* 16:9 aspect ratio */
    }
    .youtube-lite > iframe {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        border: 0;
    }
    /* The Play button */
    .youtube-lite-playbtn {
        width: 68px;
        height: 48px;
        position: absolute;
        cursor: pointer;
        transform: translate3d(-50%, -50%, 0);
        top: 50%;
        left: 50%;
        z-index: 1;
        background-color: transparent;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>');
        filter: grayscale(100%);
        transition: filter 0.1s cubic-bezier(0, 0, 0.2, 1);
    }
    .youtube-lite:hover .youtube-lite-playbtn {
        filter: none;
    }
    /* The link to YouTube */
    .youtube-lite-link {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
</style>

<script>
    function initYouTubeLite() {
        const youtubeLiteContainers = document.querySelectorAll(".youtube-lite");
        youtubeLiteContainers.forEach((container) => {
            container.addEventListener(
                "click",
                () => {
                    const iframe = document.createElement("iframe");
                    iframe.setAttribute("frameborder", "0");
                    iframe.setAttribute("allowfullscreen", "");
                    iframe.setAttribute(
                        "allow",
                        "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",
                    );
                    iframe.setAttribute(
                        "src",
                        `https://www.youtube.com/embed/${container.dataset.videoid}?autoplay=1`,
                    );
                    container.innerHTML = "";
                    container.appendChild(iframe);
                },
                { once: true },
            );
        });
    }
    // Run on initial load
    document.addEventListener("DOMContentLoaded", initYouTubeLite);
</script>
{{- end -}}
