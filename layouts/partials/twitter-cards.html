<!-- FILE: layouts/partials/twitter-cards.html (CORRECTED FOR ASSETS) -->

<!-- The type of card to display. "summary_large_image" is best for articles. -->
<meta name="twitter:card" content="summary_large_image" />

<!-- The canonical URL of your content -->
<meta name="twitter:url" content="{{ .Permalink }}" />

<!-- The title of your content -->
<meta
    name="twitter:title"
    content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}"
/>

<!-- A brief description -->
<meta
    name="twitter:description"
    content="{{ .Description | default .Summary | default .Site.Params.description | plainify }}"
/>

<!-- The @username of the website's account -->
{{ with .Site.Params.social.twitter }}
<meta name="twitter:site" content="@{{ . }}" />
{{ end }}

<!-- The @username of the content author -->
{{ with .Site.Params.author }}
<meta name="twitter:creator" content="{{ . }}" />
{{ end }}

<!-- Find and process the image for the social card -->
{{- $imagePath := "" -}}
{{- if .Params.images -}}
    {{- /* Use the first image from the 'images' array */ -}}
    {{- $imagePath = index .Params.images 0 -}}
{{- else -}}
    {{- /* Fallback to the default site image */ -}}
    {{- $imagePath = .Site.Params.defaultTwitterImage | default .Site.Params.defaultSocialImage -}}
{{- end -}}

{{- with $imagePath -}}
    {{- with resources.Get . -}}
        {{- $twitterImage := .Fill "1200x630 Center q85 jpg" -}}
        <meta name="twitter:image" content="{{ $twitterImage.Permalink | absURL }}" />
    {{- else -}}
        {{- warnf "Twitter Card Image not found in assets: %s" . -}}
    {{- end -}}
{{- end -}}
